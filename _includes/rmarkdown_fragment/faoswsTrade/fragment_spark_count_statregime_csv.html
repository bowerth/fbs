<p>Counting the number of observations by <code>year</code> and <code>stat_regime</code> between 2000 and 2014.</p>
<ul>
<li>the SWS source datatable id is <code>ce_combinednomenclature_unlogged_[year]</code></li>
<li>the result has been obtained using the following query:</li>
</ul>
<pre><code>spark.sql(&quot;SELECT year, stat_regime, COUNT(*) AS cnt FROM parquetTable GROUP BY year, stat_regime ORDER BY year, stat_regime&quot;)</code></pre>
<ul>
<li><code>count_[stat_regime]</code> is the rowcount with the respective stat_regime, e.g. <code>count_2</code> are the number of observations using stat regime 2.</li>
<li><code>pct_4</code> represents the share of stat regime 4 in the respective year, i.e.Â in 2014, 95.5% of observations used stat regime 4</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">count_2</th>
<th align="right">count_3</th>
<th align="right">count_4</th>
<th align="right">count_5</th>
<th align="right">count_6</th>
<th align="right">count_7</th>
<th align="right">count_9</th>
<th align="right">pct_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2014</td>
<td align="right">381328</td>
<td align="right">130064</td>
<td align="right">10929025</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1571</td>
<td align="right">95.5</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">397058</td>
<td align="right">135248</td>
<td align="right">10784362</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1588</td>
<td align="right">95.3</td>
</tr>
<tr class="odd">
<td align="right">2012</td>
<td align="right">406991</td>
<td align="right">136770</td>
<td align="right">10553406</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1312</td>
<td align="right">95.1</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">391238</td>
<td align="right">136060</td>
<td align="right">10190021</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1494</td>
<td align="right">95.1</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">382150</td>
<td align="right">132559</td>
<td align="right">10086377</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">10164</td>
<td align="right">95.1</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="right">NA</td>
<td align="right">120710</td>
<td align="right">9910229</td>
<td align="right">308534</td>
<td align="right">105915</td>
<td align="right">499</td>
<td align="right">NA</td>
<td align="right">94.9</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">NA</td>
<td align="right">147841</td>
<td align="right">9890763</td>
<td align="right">306820</td>
<td align="right">106509</td>
<td align="right">7807</td>
<td align="right">NA</td>
<td align="right">94.6</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="right">NA</td>
<td align="right">154912</td>
<td align="right">9788676</td>
<td align="right">318741</td>
<td align="right">95863</td>
<td align="right">12833</td>
<td align="right">NA</td>
<td align="right">94.4</td>
</tr>
<tr class="odd">
<td align="right">2006</td>
<td align="right">NA</td>
<td align="right">167631</td>
<td align="right">9613721</td>
<td align="right">365686</td>
<td align="right">85798</td>
<td align="right">9803</td>
<td align="right">NA</td>
<td align="right">93.9</td>
</tr>
<tr class="even">
<td align="right">2005</td>
<td align="right">NA</td>
<td align="right">168927</td>
<td align="right">9501055</td>
<td align="right">394324</td>
<td align="right">88208</td>
<td align="right">15556</td>
<td align="right">NA</td>
<td align="right">93.4</td>
</tr>
<tr class="odd">
<td align="right">2004</td>
<td align="right">NA</td>
<td align="right">222160</td>
<td align="right">9559596</td>
<td align="right">607108</td>
<td align="right">125278</td>
<td align="right">22603</td>
<td align="right">NA</td>
<td align="right">90.7</td>
</tr>
<tr class="even">
<td align="right">2003</td>
<td align="right">NA</td>
<td align="right">252003</td>
<td align="right">9201879</td>
<td align="right">686211</td>
<td align="right">88554</td>
<td align="right">20190</td>
<td align="right">NA</td>
<td align="right">89.8</td>
</tr>
<tr class="odd">
<td align="right">2002</td>
<td align="right">NA</td>
<td align="right">247250</td>
<td align="right">9130982</td>
<td align="right">714876</td>
<td align="right">104978</td>
<td align="right">23182</td>
<td align="right">NA</td>
<td align="right">89.3</td>
</tr>
<tr class="even">
<td align="right">2001</td>
<td align="right">NA</td>
<td align="right">244792</td>
<td align="right">8838263</td>
<td align="right">687988</td>
<td align="right">104966</td>
<td align="right">26688</td>
<td align="right">NA</td>
<td align="right">89.3</td>
</tr>
<tr class="odd">
<td align="right">2000</td>
<td align="right">NA</td>
<td align="right">243967</td>
<td align="right">8720865</td>
<td align="right">687259</td>
<td align="right">124958</td>
<td align="right">29281</td>
<td align="right">NA</td>
<td align="right">88.9</td>
</tr>
</tbody>
</table>
